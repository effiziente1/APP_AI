<div class="flex flex-col h-full gap-3">
    <app-message [messages]="allErrors()" (clear)="clearErrors()" />
    @if (messages().length > 0) {
    <div class="flex flex-col gap-2">
        @for (msg of messages(); track $index) {
        <p class="px-3 py-1 rounded-xl max-w-[80%]"
            [class]="msg.role === 'user' ? 'bg-gray-200 self-end text-black' : 'bg-blue-600 self-start text-white'">
            {{ msg.content }}
        </p>
        }
        @if (isLoading()) {
        <div class="self-start p-4 flex items-center gap-2" role="status" aria-live="polite">
            <ng-icon hlm name="lucideLoader2" class="animate-spin" size="sm" />
            <span class="text-sm text-gray-500">Assistant is thinking...</span>
        </div>
        }
    </div>
    }
    <!-- Input Area -->
    <div class="flex flex-col gap-2 items-end border-2 p-2 rounded-3xl focus-within:border-black">
        <textarea [field]="promptForm.prompt" hlmTextarea (keydown)="onKeydown($event)"
            class="w-full border-0 shadow-none focus:!border-0 focus:!outline-none focus:!ring-0 resize-none focus:shadow-none hlmTextarea"
            placeholder="Ask anything"></textarea>
        <button aria-label="Send" (click)="sendMessage()" hlmBtn class="rounded-full w-9 h-9"
            [disabled]="promptForm().invalid() || isLoading()">
            <ng-icon hlm name="lucideArrowUp" />
        </button>
    </div>
</div>